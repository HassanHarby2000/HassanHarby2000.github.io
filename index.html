<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="flutter_facebook_responsive_ui">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/png" href="favicon.png"/>

  <title>flutter_facebook_responsive_ui</title>
  <link rel="manifest" href="manifest.json">
  <script>
    let _console;

    messageHandler = function (e) {
      var obj = e.data;
      var command = obj.command;
      if (command === "hotRestart") {
        $dartHotRestart();
      }
    };

    window.addEventListener("load", function () {
      window.addEventListener("message", messageHandler, false);
      parent.postMessage({ sender: "frame", type: "ready" }, "*");

      initConsole();
    });

    function dartPrint(message) {
      if (parent) {
        parent.postMessage(
          {
            sender: "frame",
            type: "print",
            message: message,
          },
          "*"
        );
      }
    }

    function initConsole() {
      _console = window.console;
      const consoleError = _console.error;
      _console.error = function (msg) {
        sendLog(msg, "error");
        consoleError(msg);
      }
      
      const consoleInfo = _console.info
      _console.info = function (msg) {
        sendLog(msg, "info");
        consoleInfo(msg);
      }
      
      const consoleWarn = _console.warn
      _console.warn = function (msg) {
        sendLog(msg, "warning");
        consoleWarn(msg);
      }
      
      const consoleLog = _console.log
      _console.log = function (msg) {
        sendLog(msg, "text");
        consoleLog(msg);
      }

       //window.onerror = function (error) {
       //  window._lastUnhandledRejection = error;
       //  consoleError(_console, "Just an error", error);
       //  sendLog(error, "error");
       //  sendError(error);
       //};
       window.addEventListener('error', function (e) {
         window._lastError = e;
         consoleError("Event error", e);
         //sendLog(e.error.message, "error");
         //sendError(e.error);
       });
      window.addEventListener('unhandledrejection', function (e) {
        window._lastUnhandledRejection = e;
        sendLog(e.reason.message, "error");
        sendError(e.reason);
      })
    }

    function sendLog(msg, type) {
      window.parent.postMessage(
        {
          type: "log",
          sender: "frame",
          log: { message: msg, type: type },
        },
        "*"
      );
    }

    function sendError(error) {
      window.parent.postMessage(
        {
          type: "error",
          error: error,
          sender: "frame",
        },
        "*"
      );
    }

    window.$initConsole = initConsole;
    window.$sendLog = sendLog;
  </script>
</head>
<body>
  <!-- This script installs service_worker.js to provide PWA functionality to
       application. For more information, see:
       https://developers.google.com/web/fundamentals/primers/service-workers -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('flutter_service_worker.js');
      });
    }
  </script>
  <script src="main.dart.js" type="application/javascript"></script>
</body>
</html>
